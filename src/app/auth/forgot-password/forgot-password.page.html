<ion-content [fullscreen]="false">

  <div class="login-container" [class.has-keypad]="showKeypad">

    <!-- HEADER -->
    <header class="header-section">
      <div class="back-button-wrapper" (click)="goBack()">
        <ion-icon name="arrow-back-outline" class="back-icon"></ion-icon>
      </div>

      <div class="logo-wrapper">
        <img
          src="https://api.builder.io/api/v1/image/assets/TEMP/2d5826d58c22c1d10e86105e94fc8c7642f220f5?width=476"
          alt="ARS Green Steel Logo"
          class="company-logo"
        />
      </div>
    </header>

    <!-- FORM -->
    <main class="form-content">
      <!-- ERROR BANNER (same as login-mobile) -->
      <div class="error-banner" *ngIf="isError">
        <ion-icon name="close-circle" class="error-icon-badge"></ion-icon>
        <span class="error-text">{{ errorMessage }}</span>
      </div>

            <!-- PAGE HEADING -->
      <div class="title-section">
        <h2 class="login-title">Reset Password</h2>
      </div>

      <form class="login-form" (submit)="$event.preventDefault()">

        <!-- NEW PASSWORD -->
        <div
          class="input-field"
          [class.active-focus]="showKeypad && !isError"
          [class.error-state]="isError"
        >
          <div class="phone-icon-wrapper">
            <ion-icon name="lock-closed-outline" class="input-icon"></ion-icon>
          </div>

          <div class="input-wrapper">
            <input
              type="password"
              class="mobile-input"
              placeholder="New Password"
              [(ngModel)]="newPassword"
              name="newPassword"
              (focus)="activeField = 'newPassword'; showKeypad = true"
            />
          </div>
        </div>

        <!-- CONFIRM PASSWORD -->
        <div
          class="input-field"
          [class.active-focus]="showKeypad  && !isError"
          [class.error-state]="isError"
        >
          <div class="phone-icon-wrapper">
            <ion-icon name="lock-closed-outline" class="input-icon"></ion-icon>
          </div>

          <div class="input-wrapper">
            <input
              type="password"
              class="mobile-input"
              placeholder="Confirm Password"
              [(ngModel)]="confirmPassword"
              name="confirmPassword"
              (focus)="activeField = 'confirmPassword'; showKeypad = true"
            />
          </div>
        </div>

        <!-- RESET BUTTON -->
        <div class="button-container">
          <button
            type="button"
            class="otp-button"
            (click)="resetPassword()"
          >
            <span class="button-text">Reset Password</span>
          </button>
        </div>

      </form>
    </main>

    <!-- VIRTUAL KEYPAD -->
    <section class="virtual-keypad" *ngIf="showKeypad">

      <div class="keypad-toolbar">
        <div class="toolbar-left">
          <ion-icon
            name="chevron-down"
            class="toolbar-icon"
            (click)="closeKeypad()"
          ></ion-icon>
        </div>

        <div class="toolbar-center">
          <span class="gif-text">GIF</span>
          <ion-icon name="settings-sharp" class="toolbar-icon"></ion-icon>
          <ion-icon name="language" class="toolbar-icon"></ion-icon>
          <ion-icon name="happy-outline" class="toolbar-icon"></ion-icon>
          <ion-icon name="ellipsis-horizontal" class="toolbar-icon"></ion-icon>
        </div>

        <div class="toolbar-right">
          <ion-icon name="mic" class="toolbar-icon"></ion-icon>
        </div>
      </div>

      <div class="keypad-grid">
        <div class="keypad-row" *ngFor="let row of currentKeys">
          <button
            class="key-btn"
            *ngFor="let k of row"
            (click)="onKeyPress(k)"
          >
            <span class="num">{{ k }}</span>
          </button>
        </div>

        <div class="keypad-row bottom-row">
          <button class="key-btn action-btn" (click)="toggleKeyboard()">
            <span class="num">{{ keyboardMode === 'abc' ? '123' : 'ABC' }}</span>
          </button>

          <button class="key-btn" (click)="onKeyPress(' ')">
            <span class="num">Space</span>
          </button>

          <button class="key-btn action-btn" (click)="onKeyPress('BACKSPACE')">
            <ion-icon name="backspace-outline" class="action-icon"></ion-icon>
          </button>
        </div>
      </div>

    </section>

  </div>
</ion-content>
